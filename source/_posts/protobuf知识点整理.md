---
title: protobuf的优缺点
date: 2018-9-17 19:15:39
tags:
category: 计算机网络
---


Google Protocol Buffer(简称 Protobuf)是一种轻便高效的结构化数据存储格式，平台无关、语言无关、可扩展，可用于通讯协议和数据存储等领域。它是Google的开源项目，目前可以将proto文件编译成C++、Java、Python三种代码文件。

**优点：**
1、性能好/效率高：时间开销： XML格式化（序列化）的开销还好；但是XML解析（反序列化）的开销就不敢恭维了。 但是protobuf在这个方面就进行了优化。可以使序列化和反序列化的时间开销都减短。空间开销：也减少了很多。

什么是序列化和反序列化？
把对象转换为字节序列的过程称为对象的序列化；把字节序列恢复为对象的过程称为对象的反序列化。

2、有代码生成机制
比如你你写个一下类似结构体的内容
```
 message testA  
{  
    required int32 m_testA = 1;  
}  
```
像写一个这样的结构，protobuf可以自动生成它的.h 文件和点.cpp文件。
protobuf将对结构体testA的操作封装成一个类。
3、支持向后兼容和向前兼容
当客户端和服务器同事使用一块协议的时候， 当客户端在协议中增加一个字节，并不会影响客户端的使用
4、支持多种编程语言
在Google官方发布的源代码中包含了c++、java、Python三种语言。

**缺点：**
1、二进制格式导致可读性差
为了提高性能，protobuf采用了二进制格式进行编码。这直接导致了可读性差。这个直接影响开发测试时候的效率。当然，一般情况下，protobuf非常可靠，并不会出现太大的问题。
2、缺乏自描述
一般来说，XML是自描述的，而protobuf格式则不是。 给你一段二进制格式的协议内容，不配合你写的结构体是看不出来什么作用的。
3、通用性差
protobuf虽然支持了大量语言的序列化和反序列化，但仍然并不是一个跨平台和语言的传输标准。在多平台消息传递中，对其他项目的兼容性并不是很好，需要做相应的适配改造工作。相比json 和 XML，通用性还是没那么好。



